<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°ìˆ˜ í›„ ê°•ì˜ í‰ê°€</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#10b981',
                        'primary-dark': '#047857',
                        'secondary-gray': '#f3f4f6',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* 'Inter' í°íŠ¸ ë° í•œêµ­ì–´ ì‹œìŠ¤í…œ í°íŠ¸ ì ìš© */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
            background-color: #f7f9fb;
        }
        .rating-label {
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
            border-radius: 0.5rem; /* rounded-lg */
        }
        input[type="radio"]:checked + .rating-label {
            background-color: #10b981; /* primary-blue */
            color: white;
            box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.5), 0 2px 4px -2px rgba(16, 185, 129, 0.5); /* shadow-lg on check */
            transform: scale(1.05);
        }
        /* Hide default radio buttons */
        input[type="radio"] {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="app" class="w-full max-w-2xl bg-white p-6 md:p-10 rounded-xl shadow-2xl space-y-8">
        <header class="text-center space-y-2">
            <h1 class="text-3xl font-extrabold text-gray-800">ì—°ìˆ˜ í›„ ê°•ì˜ í‰ê°€</h1>
            <p class="text-gray-500 text-lg">ê·€í•œ ì˜ê²¬ì„ ë‚¨ê²¨ì£¼ì‹œë©´ ê°•ì˜ ê°œì„ ì— í° ë„ì›€ì´ ë©ë‹ˆë‹¤. (5ì : ë§¤ìš° ë§Œì¡± ~ 1ì : ë¶ˆë§Œì¡±)</p>
        </header>

        <form id="evaluationForm" class="space-y-6">
            <!-- í‰ê°€ í•­ëª© ëª©ë¡ -->
            <div id="question-list" class="space-y-6">
                <!-- ì§ˆë¬¸ ì»´í¬ë„ŒíŠ¸ëŠ” JavaScriptë¡œ ë™ì  ìƒì„±ë©ë‹ˆë‹¤. -->
            </div>

            <!-- ê¸°íƒ€ ì˜ê²¬ (ì„ íƒ ì‚¬í•­) -->
            <div class="space-y-3">
                <label for="other_feedback" class="block text-lg font-semibold text-gray-700">6. ê¸°íƒ€ ì˜ê²¬ (ì„ íƒ ì‚¬í•­)</label>
                <textarea id="other_feedback" name="other_feedback" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue transition duration-150" placeholder="ììœ ë¡œìš´ ì˜ê²¬ì„ ì‘ì„±í•´ ì£¼ì„¸ìš”."></textarea>
            </div>

            <!-- ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ -->
            <div id="message-area" class="text-center"></div>

            <!-- ì œì¶œ ë²„íŠ¼ -->
            <button type="submit" id="submitBtn" class="w-full bg-primary-blue hover:bg-primary-dark text-white font-bold py-3 rounded-xl shadow-lg transition duration-200 transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-primary-blue focus:ring-opacity-50" disabled>
                í‰ê°€ ì œì¶œí•˜ê¸°
            </button>
        </form>

    </div>

    <script>
        // ì‚¬ìš©ìê»˜ì„œ ë‚˜ì¤‘ì— ë°°í¬í•œ Google Apps Script Web Appì˜ URLì„ ì—¬ê¸°ì— ë„£ì–´ì£¼ì„¸ìš”.
        const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwpZShLIgS3bFkIyOrbt6IjuLOMbs4qBTKGg_WTcgVXEuj-fDfffkJqWD4wQYZaGhUT/exec";

        const questions = [
            { id: 'content_satisfaction', label: '1. ê°•ì˜ ë‚´ìš© êµ¬ì„± ë§Œì¡±ë„' },
            { id: 'instructor_delivery', label: '2. ê°•ì‚¬ ì „ë‹¬ë ¥ ë§Œì¡±ë„' },
            { id: 'material_utilization', label: '3. êµì¬ ë° ìë£Œ í™œìš©ë„' },
            { id: 'practical_usefulness', label: '4. ì‹¤ë¬´ ì ìš© ë° ìœ ìš©ì„±' },
            { id: 'overall_recommendation', label: '5. ì „ë°˜ì ì¸ ì¶”ì²œ ì˜í–¥' },
        ];

        const ratings = [
            { value: 5, text: 'ë§¤ìš° ë§Œì¡±' },
            { value: 4, text: 'ë§Œì¡±' },
            { value: 3, text: 'ë³´í†µ' },
            { value: 2, text: 'ë¶ˆë§Œì¡±' },
            { value: 1, text: 'ë§¤ìš° ë¶ˆë§Œì¡±' }
        ];

        const questionList = document.getElementById('question-list');
        const form = document.getElementById('evaluationForm');
        const submitBtn = document.getElementById('submitBtn');
        const messageArea = document.getElementById('message-area');

        // í¼ í•„ë“œ ë™ì  ìƒì„± í•¨ìˆ˜
        function createQuestionElement(question) {
            const container = document.createElement('div');
            container.className = 'space-y-3 p-4 bg-secondary-gray rounded-lg border border-gray-200';

            const label = document.createElement('label');
            label.className = 'block text-lg font-semibold text-gray-700';
            label.textContent = question.label;

            const ratingContainer = document.createElement('div');
            ratingContainer.className = 'flex flex-wrap justify-between gap-2';

            ratings.forEach(rating => {
                const inputId = `${question.id}-${rating.value}`;

                const input = document.createElement('input');
                input.type = 'radio';
                input.id = inputId;
                input.name = question.id;
                input.value = rating.value;
                input.required = true;

                const ratingLabel = document.createElement('label');
                ratingLabel.htmlFor = inputId;
                ratingLabel.className = 'rating-label flex-1 text-center py-2 px-2 text-sm font-medium text-gray-600 bg-white border border-gray-300 hover:bg-gray-100 min-w-[70px]';
                ratingLabel.textContent = rating.text;

                ratingContainer.appendChild(input);
                ratingContainer.appendChild(ratingLabel);
            });

            container.appendChild(label);
            container.appendChild(ratingContainer);
            questionList.appendChild(container);
        }

        // ëª¨ë“  ì§ˆë¬¸ í•­ëª© ìƒì„±
        questions.forEach(createQuestionElement);

        // í¼ ìœ íš¨ì„± ê²€ì‚¬ ë° ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™”
        function checkValidity() {
            // ëª¨ë“  required í•„ë“œê°€ ì²´í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸
            const isAllRequiredFilled = form.checkValidity();
            submitBtn.disabled = !isAllRequiredFilled;
        }

        // ì´ˆê¸° ìœ íš¨ì„± ê²€ì‚¬ ë° ì…ë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.addEventListener('DOMContentLoaded', () => {
            checkValidity(); // ì´ˆê¸° ìƒíƒœ í™•ì¸
            form.addEventListener('change', checkValidity); // ë¼ë””ì˜¤ ë²„íŠ¼ ì„ íƒ ì‹œë§ˆë‹¤ í™•ì¸
        });


        // í¼ ì œì¶œ ì²˜ë¦¬ í•¨ìˆ˜
        async function submitEvaluation(event) {
            event.preventDefault();

            if (GAS_WEB_APP_URL.includes("YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE")) {
                showMessage("error", "Google Apps Script URLì„ ë¨¼ì € ì„¤ì •í•´ ì£¼ì„¸ìš”.");
                return;
            }

            // ëª¨ë“  í•„ìˆ˜ í•­ëª©ì´ ì±„ì›Œì¡ŒëŠ”ì§€ ë‹¤ì‹œ í™•ì¸
            if (!form.checkValidity()) {
                showMessage("error", "ëª¨ë“  í‰ê°€ í•­ëª©ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
                return;
            }

            submitBtn.textContent = 'ì œì¶œ ì¤‘...';
            submitBtn.disabled = true;
            messageArea.innerHTML = '';

            // í¼ ë°ì´í„°ë¥¼ URLSearchParams ê°ì²´ë¡œ ìˆ˜ì§‘ (GET/POST ìš”ì²­ì— ì í•©)
            const formData = new FormData(form);
            const data = new URLSearchParams();

            for (const [key, value] of formData.entries()) {
                data.append(key, value);
            }

            try {
                // Google Apps ScriptëŠ” ê¸°ë³¸ì ìœ¼ë¡œ application/x-www-form-urlencoded í˜•ì‹ì˜ POST ìš”ì²­ì„ ê¸°ëŒ€í•©ë‹ˆë‹¤.
                const response = await fetch(GAS_WEB_APP_URL, {
                    method: 'POST',
                    mode: 'no-cors', // CORS ì •ì±… ìš°íšŒë¥¼ ìœ„í•´ no-cors ëª¨ë“œ ì‚¬ìš© (GAS ì›¹ì•± íŠ¹ì„±)
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: data.toString()
                });

                // no-cors ëª¨ë“œì—ì„œëŠ” ì‘ë‹µ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ,
                // ì„±ê³µ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ê³  í¼ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
                showMessage("success", "âœ… í‰ê°€ê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!");
                form.reset();
                checkValidity(); // í¼ ì´ˆê¸°í™” í›„ ë‹¤ì‹œ ë²„íŠ¼ ë¹„í™œì„±í™”
                
            } catch (error) {
                console.error('ì œì¶œ ì˜¤ë¥˜:', error);
                showMessage("error", "âŒ ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
            } finally {
                submitBtn.textContent = 'í‰ê°€ ì œì¶œí•˜ê¸°';
                submitBtn.disabled = false;
            }
        }

        // ë©”ì‹œì§€ í‘œì‹œ ìœ í‹¸ë¦¬í‹°
        function showMessage(type, content) {
            let color, icon;
            if (type === "success") {
                color = "text-primary-blue";
                icon = "ğŸ‘";
            } else if (type === "error") {
                color = "text-red-500";
                icon = "ğŸš¨";
            }

            messageArea.innerHTML = `
                <div class="p-3 ${color} font-bold rounded-lg transition duration-300">
                    ${icon} ${content}
                </div>
            `;
        }

        // í¼ ì œì¶œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        form.addEventListener('submit', submitEvaluation);

    </script>
</body>
</html>